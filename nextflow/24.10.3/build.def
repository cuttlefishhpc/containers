Bootstrap: docker
From: debian:bookworm

%labels
    Author "Andrew S. Tupper, PhD"
    Version "1.0"
    Description "Container for running nextflow 24.10.3"
    Maintainer "Andrew S. Tupper <tuppera@uncw.edu>"
    License "MIT"

%post
    set -e
    
    echo "creating HPC mount points"
    mkdir -p /storage /scratch

    echo "Installing dependencies"
    apt-get update && apt-get install -y curl openjdk-17-jre-headless which
    
    echo "Installing nextflow"
    curl -s https://get.nextflow.io | bash
    mv nextflow /usr/local/bin/
    chmod +x /usr/local/bin/nextflow

%environment
    export PATH=/usr/local/bin:$PATH
    export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64

%runscript
    exec nextflow "$@"
